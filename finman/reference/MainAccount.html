<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>MainAccount Class — MainAccount • finman</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MainAccount Class — MainAccount"><meta name="description" content="The `MainAccount` R6 class represents the top-level virtual account in a
hierarchical financial structure. It receives all income and is responsible
for distributing funds to its child accounts based on allocation rules.
This class is the core of the budgeting engine and manages:
Income reception and logging.
Transaction tracking via a structured data frame.
A list of linked child accounts.
Auto-generated UUID for identification.
A balance that reflects both manual and system transactions.

"><meta property="og:description" content="The `MainAccount` R6 class represents the top-level virtual account in a
hierarchical financial structure. It receives all income and is responsible
for distributing funds to its child accounts based on allocation rules.
This class is the core of the budgeting engine and manages:
Income reception and logging.
Transaction tracking via a structured data frame.
A list of linked child accounts.
Auto-generated UUID for identification.
A balance that reflects both manual and system transactions.

"><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">finman</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/account_lifecycle.html">Account Lifecycle and Behavior</a></li>
    <li><a class="dropdown-item" href="../articles/allocation_strategies.html">Income Allocation Strategies</a></li>
    <li><a class="dropdown-item" href="../articles/finman-overview.html">finman-overview</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/statisticsguru1/personal-finance-manager/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>MainAccount Class</h1>
      <small class="dont-index">Source: <a href="https://github.com/statisticsguru1/personal-finance-manager/blob/refactor-main-account-docs/R/master_account.R" class="external-link"><code>R/master_account.R</code></a></small>
      <div class="d-none name"><code>MainAccount.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The `MainAccount` R6 class represents the top-level virtual account in a
hierarchical financial structure. It receives all income and is responsible
for distributing funds to its child accounts based on allocation rules.</p>
<p>This class is the core of the budgeting engine and manages:</p><ul><li><p>Income reception and logging.</p></li>
<li><p>Transaction tracking via a structured data frame.</p></li>
<li><p>A list of linked child accounts.</p></li>
<li><p>Auto-generated UUID for identification.</p></li>
<li><p>A balance that reflects both manual and system transactions.</p></li>
</ul></div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The account includes the following core attributes:</p><dl><dt>uuid</dt>
<dd><p>A unique identifier for the account, auto-generated.</p></dd>

  <dt>name</dt>
<dd><p>Human-readable name for the account.</p></dd>

  <dt>balance</dt>
<dd><p>Current balance in the account.</p></dd>

  <dt>transactions</dt>
<dd><p>A `data.frame` tracking transaction logs, including
  custom system transactions.</p></dd>

  <dt>transaction_counter</dt>
<dd><p>Used internally to create unique transaction
  IDs.</p></dd>

  <dt>child_accounts</dt>
<dd><p>A list containing attached child accounts.</p></dd>

  <dt>total_allocation</dt>
<dd><p>Tracks the total allocation distributed to
  children.</p></dd>

  <dt>path</dt>
<dd><p>Logical traversal path from the root (used to locate accounts
  hierarchically).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="hierarchy">Hierarchy<a class="anchor" aria-label="anchor" href="#hierarchy"></a></h2>


<p>This is the top-level class in a hierarchy that includes:</p><ul><li><p><strong>MainAccount</strong>: Root of the virtual budget system.</p></li>
<li><p><strong>ChildAccount</strong>: Draws a portion of income from the
  MainAccount.</p></li>
<li><p><strong>GrandChildAccount</strong>: Represents specific budget goals
  (e.g., rent, savings) and has due dates, frequency, and priority logic.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>uuid</code></dt>
<dd><p>Auto-generated unique identifier.</p></dd>


<dt><code>name</code></dt>
<dd><p>Account name.</p></dd>


<dt><code>balance</code></dt>
<dd><p>Current balance.</p></dd>


<dt><code>transactions</code></dt>
<dd><p>A `data.frame` of transaction logs.</p></dd>


<dt><code>transaction_counter</code></dt>
<dd><p>Counter used to generate unique transaction IDs.</p></dd>


<dt><code>child_accounts</code></dt>
<dd><p>List of child accounts.</p></dd>


<dt><code>total_allocation</code></dt>
<dd><p>Numeric. Sum of allocated funds to children.</p></dd>


<dt><code>path</code></dt>
<dd><p>Character vector representing the account's hierarchy path.</p>
<p># some imports</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-MainAccount-new"><code>MainAccount$new()</code></a></p></li>
<li><p><a href="#method-MainAccount-generate_transaction_id"><code>MainAccount$generate_transaction_id()</code></a></p></li>
<li><p><a href="#method-MainAccount-is_duplicate_transaction"><code>MainAccount$is_duplicate_transaction()</code></a></p></li>
<li><p><a href="#method-MainAccount-deposit"><code>MainAccount$deposit()</code></a></p></li>
<li><p><a href="#method-MainAccount-distribute_to_children"><code>MainAccount$distribute_to_children()</code></a></p></li>
<li><p><a href="#method-MainAccount-add_child_account"><code>MainAccount$add_child_account()</code></a></p></li>
<li><p><a href="#method-MainAccount-set_child_allocation"><code>MainAccount$set_child_allocation()</code></a></p></li>
<li><p><a href="#method-MainAccount-withdraw"><code>MainAccount$withdraw()</code></a></p></li>
<li><p><a href="#method-MainAccount-get_balance"><code>MainAccount$get_balance()</code></a></p></li>
<li><p><a href="#method-MainAccount-get_transactions"><code>MainAccount$get_transactions()</code></a></p></li>
<li><p><a href="#method-MainAccount-list_child_accounts"><code>MainAccount$list_child_accounts()</code></a></p></li>
<li><p><a href="#method-MainAccount-find_account"><code>MainAccount$find_account()</code></a></p></li>
<li><p><a href="#method-MainAccount-find_account_by_uuid"><code>MainAccount$find_account_by_uuid()</code></a></p></li>
<li><p><a href="#method-MainAccount-move_balance"><code>MainAccount$move_balance()</code></a></p></li>
<li><p><a href="#method-MainAccount-list_all_accounts"><code>MainAccount$list_all_accounts()</code></a></p></li>
<li><p><a href="#method-MainAccount-compute_total_balance"><code>MainAccount$compute_total_balance()</code></a></p></li>
<li><p><a href="#method-MainAccount-compute_total_due"><code>MainAccount$compute_total_due()</code></a></p></li>
<li><p><a href="#method-MainAccount-compute_total_due_within_n_days"><code>MainAccount$compute_total_due_within_n_days()</code></a></p></li>
<li><p><a href="#method-MainAccount-spending"><code>MainAccount$spending()</code></a></p></li>
<li><p><a href="#method-MainAccount-total_income"><code>MainAccount$total_income()</code></a></p></li>
<li><p><a href="#method-MainAccount-allocated_amount"><code>MainAccount$allocated_amount()</code></a></p></li>
<li><p><a href="#method-MainAccount-income_utilization"><code>MainAccount$income_utilization()</code></a></p></li>
<li><p><a href="#method-MainAccount-walking_amount"><code>MainAccount$walking_amount()</code></a></p></li>
<li><p><a href="#method-MainAccount-clone"><code>MainAccount$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-MainAccount-new"></a><div class="section">
<h3 id="method-new-">Method <code><a href="https://rdrr.io/r/methods/new.html" class="external-link">new()</a></code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Constructor for the `MainAccount` class. Initializes a new main account
with a unique identifier, user-defined name, zero balance, and an empty
transaction data frame. Also sets the default account path to
"main_account".</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/MainAccount.html">MainAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">name</span>, balance <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>Character. The name of the main account. Used for
identification in the app UI and reports.</p></dd>


<dt><code>balance</code></dt>
<dd><p>Numeric. Initial balance for the account.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
main_acc &lt;- MainAccount$new(name = "My Main Account")
print(main_acc$uuid)
print(main_acc$balance)
print(main_acc$transactions)
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-generate_transaction_id"></a><div class="section">
<h3 id="method-generate-transaction-id-">Method <code>generate_transaction_id()</code><a class="anchor" aria-label="anchor" href="#method-generate-transaction-id-"></a></h3>
<p>Generates a unique system transaction ID by appending an incrementing
counter to a fixed prefix ("sys"). The counter is then incremented for
future calls.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">generate_transaction_id</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>A character string representing the generated transaction ID.</p>
</div>
<div class="section">
<h4 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new(name = "Salary Pool")
  txn_id1 &lt;- main_acc$generate_transaction_id()
  txn_id2 &lt;- main_acc$generate_transaction_id()
  print(txn_id1)  # e.g., "sys1"
  print(txn_id2)  # e.g., "sys2"
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-is_duplicate_transaction"></a><div class="section">
<h3 id="method-is-duplicate-transaction-">Method <code>is_duplicate_transaction()</code><a class="anchor" aria-label="anchor" href="#method-is-duplicate-transaction-"></a></h3>
<p>Checks if a given transaction number already exists in the transaction
log. This is used to prevent duplicate transaction entries.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">is_duplicate_transaction</span><span class="op">(</span><span class="va">transaction_number</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>transaction_number</code></dt>
<dd><p>Character. The transaction ID to be checked.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>Logical. <code>TRUE</code> if the transaction number exists,
<code>FALSE</code> otherwise.</p>
</div>
<div class="section">
<h4 id="examples-2">Examples<a class="anchor" aria-label="anchor" href="#examples-2"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  # Create a new main account
  main_acc &lt;- MainAccount$new(name = "Salary Pool")

  # Manually add a transaction with ID "sys1"
  main_acc$transactions &lt;- data.frame(
    Type = "Income",
    By = "User",
    TransactionID = "sys1",
    Channel = "Bank",
    Amount = 5000,
    Balance = 5000,
    amount_due = 0,
    overall_balance = 5000,
    Date = Sys.time(),
    stringsAsFactors = FALSE
  )

  # Check for duplicate
  main_acc$is_duplicate_transaction("sys1")  # Returns TRUE
  main_acc$is_duplicate_transaction("sys2")  # Returns FALSE
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-deposit"></a><div class="section">
<h3 id="method-deposit-">Method <code>deposit()</code><a class="anchor" aria-label="anchor" href="#method-deposit-"></a></h3>
<p>Deposits a specified amount into the account and distributes it
to child accounts based on allocation rules. This method also records
the transaction in the internal ledger.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span></span>
<span>  <span class="va">amount</span>,</span>
<span>  transaction_number <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"User"</span>,</span>
<span>  channel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>amount</code></dt>
<dd><p>Numeric. The amount of money to deposit. Must be greater
than zero.</p></dd>


<dt><code>transaction_number</code></dt>
<dd><p>Optional character. A unique identifier for
this transaction. If not provided, the system generates one
automatically.</p></dd>


<dt><code>by</code></dt>
<dd><p>Character. Identifier of the depositor (default is `"User"`).</p></dd>


<dt><code>channel</code></dt>
<dd><p>Character. The source of funds
(e.g., `"ABSA"`, `"MPESA"`). Required.</p></dd>


<dt><code>date</code></dt>
<dd><p>POSIXct or character. The timestamp of the transaction
(defaults to current time).</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>No return value. The method updates the account balance,
transaction log, and distributes funds to child accounts.</p>
</div>
<div class="section">
<h4 id="examples-3">Examples<a class="anchor" aria-label="anchor" href="#examples-3"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new(name = "Salary Pool")
  main_acc$deposit(
    amount = 1000,
    channel = "Bank Transfer"
  )
}

</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-distribute_to_children"></a><div class="section">
<h3 id="method-distribute-to-children-">Method <code>distribute_to_children()</code><a class="anchor" aria-label="anchor" href="#method-distribute-to-children-"></a></h3>
<p>Distributes a given amount from the an account to active child accounts
based on their allocation weights and priorities. If the amount is too
small (less than 0.10), it is routed entirely to the highest-priority
child.</p>
<p>This method is automatically called after a deposit into a parent
account. It performs internal withdrawals and instructs child accounts
to deposit their corresponding shares.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">distribute_to_children</span><span class="op">(</span><span class="va">amount</span>, <span class="va">transaction</span>, by <span class="op">=</span> <span class="st">"System"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>amount</code></dt>
<dd><p>Numeric. Total amount available for distribution.</p></dd>


<dt><code>transaction</code></dt>
<dd><p>Character. The transaction ID associated with the
distribution.</p></dd>


<dt><code>by</code></dt>
<dd><p>Character. Identifier of the actor performing the transfer
(default is `"System"`).</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>No return value. This method updates balances and transaction
logs in both the main account and all affected child accounts.</p>
</div>
<div class="section">
<h4 id="examples-4">Examples<a class="anchor" aria-label="anchor" href="#examples-4"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new(name = "Salary Pool")
  child1 &lt;- ChildAccount$new(name = "Food Fund", allocation = 0.6)
  child2 &lt;- ChildAccount$new(name = "Savings", allocation = 0.4)
  main_acc$add_child_account(child1)
  main_acc$add_child_account(child2)

  main_acc$deposit(amount = 1000, channel = "Bank")
  # This will trigger distribute_to_children internally.
}

</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-add_child_account"></a><div class="section">
<h3 id="method-add-child-account-">Method <code>add_child_account()</code><a class="anchor" aria-label="anchor" href="#method-add-child-account-"></a></h3>
<p>Adds a `ChildAccount` object to the list of child accounts of the
account.
It checks for valid allocation percentages (must not exceed 100<!-- %), sets -->
hierarchical path references, and updates total allocation.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child_account</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>child_account</code></dt>
<dd><p>An object of class `ChildAccount`or
`GrandChildAccount`, representing the account to be added as a
subordinate of the current main account.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a></h4>
<p>If the child's allocation is zero, it will be automatically marked as
inactive. The method also updates the logical `path` of the child and
attaches a `parent` reference to maintain the hierarchy.</p>
</div>

<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>None. This method modifies the object in-place.</p>
</div>
<div class="section">
<h4 id="examples-5">Examples<a class="anchor" aria-label="anchor" href="#examples-5"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new(name = "Master")
  child_acc &lt;- ChildAccount$new(name = "Savings", allocation = 0.4)
  main_acc$add_child_account(child_acc)
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-set_child_allocation"></a><div class="section">
<h3 id="method-set-child-allocation-">Method <code>set_child_allocation()</code><a class="anchor" aria-label="anchor" href="#method-set-child-allocation-"></a></h3>
<p>Updates the allocation percentage for a specified child account.
Ensures that the total allocation across all children does not exceed
 100<!-- % (1.0). --></p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">set_child_allocation</span><span class="op">(</span><span class="va">child_account_name</span>, <span class="va">new_allocation</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>child_account_name</code></dt>
<dd><p>Character. The name of the child account
whose allocation is to be updated.</p></dd>


<dt><code>new_allocation</code></dt>
<dd><p>Numeric. The new allocation proportion
(between 0 and 1).</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-2">Details<a class="anchor" aria-label="anchor" href="#details-2"></a></h4>
<p>If the allocation is set to zero, the child account is marked as
inactive. The function automatically updates the total allocation
tracker.</p>
</div>

<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>None. This method modifies the object in-place.</p>
</div>
<div class="section">
<h4 id="examples-6">Examples<a class="anchor" aria-label="anchor" href="#examples-6"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Main")
  child &lt;- ChildAccount$new(name = "Emergency", allocation = 0.2)
  main_acc$add_child_account(child)
  main_acc$set_child_allocation("Emergency", 0.3)
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-withdraw"></a><div class="section">
<h3 id="method-withdraw-">Method <code>withdraw()</code><a class="anchor" aria-label="anchor" href="#method-withdraw-"></a></h3>
<p>Withdraws a specified amount from the account and logs the
transaction. A transaction number is generated automatically if not
 provided. Withdrawals require a valid channel and sufficient balance.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">withdraw</span><span class="op">(</span></span>
<span>  <span class="va">amount</span>,</span>
<span>  transaction_number <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"User"</span>,</span>
<span>  channel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>amount</code></dt>
<dd><p>Numeric. The amount to withdraw. Must be greater than
zero and
#' not exceed the current balance.</p></dd>


<dt><code>transaction_number</code></dt>
<dd><p>Optional character. Custom transaction ID.
If NULL,
a system-generated ID will be used.</p></dd>


<dt><code>by</code></dt>
<dd><p>Character. The entity initiating the withdrawal. Default is
`"User"`.</p></dd>


<dt><code>channel</code></dt>
<dd><p>Character. The withdrawal channel (e.g., "Bank Transfer").
Required.</p></dd>


<dt><code>date</code></dt>
<dd><p>POSIXct. Timestamp for the transaction. Defaults to
`Sys.time()`.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>None. Modifies the object's internal state by reducing the
balance and appending a new transaction to the log.</p>
</div>
<div class="section">
<h4 id="examples-7">Examples<a class="anchor" aria-label="anchor" href="#examples-7"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Primary Pool")
  main_acc$deposit(amount = 1000, channel = "Mobile", by = "User")
  main_acc$withdraw(amount = 200, channel = "ATM", by = "User")
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-get_balance"></a><div class="section">
<h3 id="method-get-balance-">Method <code>get_balance()</code><a class="anchor" aria-label="anchor" href="#method-get-balance-"></a></h3>
<p>Returns the current balance of the account and prints it to the
console.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">get_balance</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p>Numeric. The current account balance.</p>
</div>
<div class="section">
<h4 id="examples-8">Examples<a class="anchor" aria-label="anchor" href="#examples-8"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Primary Pool")
  main_acc$deposit(amount = 500, channel = "Bank Transfer")
  main_acc$get_balance()
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-get_transactions"></a><div class="section">
<h3 id="method-get-transactions-">Method <code>get_transactions()</code><a class="anchor" aria-label="anchor" href="#method-get-transactions-"></a></h3>
<p>Retrieves and displays the transaction history for the account.
If no transactions are found, a message is printed. Otherwise, the
transaction log is displayed in the console.</p>
<p>This method is inherited by child and grandchild account classes.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">get_transactions</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-8">Returns<a class="anchor" aria-label="anchor" href="#returns-8"></a></h4>
<p>A data frame containing the account's transaction history.</p>
</div>
<div class="section">
<h4 id="examples-9">Examples<a class="anchor" aria-label="anchor" href="#examples-9"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  acc &lt;- MainAccount$new("Main Budget")
  acc$deposit(500, channel = "M-Pesa")
  acc$get_transactions()
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-list_child_accounts"></a><div class="section">
<h3 id="method-list-child-accounts-">Method <code>list_child_accounts()</code><a class="anchor" aria-label="anchor" href="#method-list-child-accounts-"></a></h3>
<p>Lists all direct child accounts attached to this account.
If no child accounts are found, a message is printed.</p>
<p>This method is inherited by both `ChildAccount` and `GrandChildAccount`,
allowing recursive visibility into nested account structures.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">list_child_accounts</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-9">Returns<a class="anchor" aria-label="anchor" href="#returns-9"></a></h4>
<p>Invisibly returns a character vector of child account names.</p>
</div>
<div class="section">
<h4 id="examples-10">Examples<a class="anchor" aria-label="anchor" href="#examples-10"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Main Budget")
  child &lt;- ChildAccount$new("Bills", allocation = 0.5)
  main_acc$add_child_account(child)
  main_acc$list_child_accounts()
}
# Recursively find all accounts by name

</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-find_account"></a><div class="section">
<h3 id="method-find-account-">Method <code>find_account()</code><a class="anchor" aria-label="anchor" href="#method-find-account-"></a></h3>
<p>Recursively searches the current account, its children, and its parent
chain to collect **all** accounts with a given name. This version differs
from the original by not stopping at the first match—it returns a list of
**all** matches instead.</p>
<p>It avoids infinite recursion by tracking visited account paths.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">find_account</span><span class="op">(</span><span class="va">target_name</span>, visited_paths <span class="op">=</span> <span class="cn">NULL</span>, matches <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>target_name</code></dt>
<dd><p>Character. The name of the account(s) to locate.</p></dd>


<dt><code>visited_paths</code></dt>
<dd><p>(Internal use only) Tracks visited paths to avoid
cycles.</p></dd>


<dt><code>matches</code></dt>
<dd><p>(Internal use only) A list to accumulate matches during
recursion.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-10">Returns<a class="anchor" aria-label="anchor" href="#returns-10"></a></h4>
<p>A list of account objects matching the given name. If no matches are
found, returns an empty list.</p>
</div>
<div class="section">
<h4 id="examples-11">Examples<a class="anchor" aria-label="anchor" href="#examples-11"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main &lt;- MainAccount$new("Main")
  savings1 &lt;- ChildAccount$new("Savings", allocation = 0.5)
  savings2 &lt;- ChildAccount$new("Savings", allocation = 0.3)
  main$add_child_account(savings1)
  main$add_child_account(savings2)
  found &lt;- main$find_account("Savings")
  length(found)  # 2
  found[[1]]$uuid
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-find_account_by_uuid"></a><div class="section">
<h3 id="method-find-account-by-uuid-">Method <code>find_account_by_uuid()</code><a class="anchor" aria-label="anchor" href="#method-find-account-by-uuid-"></a></h3>
<p>Recursively searches for an account by its unique UUID. The method
traverses downward through all child accounts and upward to the parent,
if needed, while preventing circular recursion by tracking visited paths.
This is especially useful when account names are not unique but UUIDs
are.</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">find_account_by_uuid</span><span class="op">(</span><span class="va">target_uuid</span>, visited_paths <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>target_uuid</code></dt>
<dd><p>Character. The UUID of the account to find.</p></dd>


<dt><code>visited_paths</code></dt>
<dd><p>Internal use only. A list used to track visited
paths and prevent infinite loops in cyclic or nested account structures.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-11">Returns<a class="anchor" aria-label="anchor" href="#returns-11"></a></h4>
<p>Returns the account object whose UUID matches the target, or <code>NULL</code>
if no match is found.</p>
</div>
<div class="section">
<h4 id="examples-12">Examples<a class="anchor" aria-label="anchor" href="#examples-12"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Root")
  groceries &lt;- ChildAccount$new("Groceries", allocation = 0.3)
  main_acc$add_child_account(groceries)
  found &lt;- main_acc$find_account_by_uuid(groceries$uuid)
  if (!is.null(found)) cat("Found UUID:", found$uuid)
}
# Move balance to another account (by UUID)

</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-move_balance"></a><div class="section">
<h3 id="method-move-balance-">Method <code>move_balance()</code><a class="anchor" aria-label="anchor" href="#method-move-balance-"></a></h3>
<p>Moves a specified amount from the current account to another account
identified by its **UUID**. This is intended for internal transfers
within the account tree. It reuses `withdraw()` and `deposit()` logic
and logs the transfer using the "Internal Transfer" channel.</p>
<p>The target account is resolved using `find_account_by_uuid()`,
not by name. This ensures unambiguous targeting even when accounts
share the same name.</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">move_balance</span><span class="op">(</span><span class="va">target_account_uuid</span>, <span class="va">amount</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>target_account_uuid</code></dt>
<dd><p>Character. The UUID of the account to which
the funds will be moved.</p></dd>


<dt><code>amount</code></dt>
<dd><p>Numeric. The amount to transfer. Must be less than or equal
to the current account's balance.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-12">Returns<a class="anchor" aria-label="anchor" href="#returns-12"></a></h4>
<p>No return value. Side effects include balance updates and transaction
logs for both the source and target accounts.</p>
</div>
<div class="section">
<h4 id="examples-13">Examples<a class="anchor" aria-label="anchor" href="#examples-13"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Main")
  savings &lt;- ChildAccount$new("Savings", allocation = 0.5)
  emergency &lt;- ChildAccount$new("Emergency", allocation = 0.5)
  main_acc$add_child_account(savings)
  main_acc$add_child_account(emergency)

  # Initial deposit
  main_acc$deposit(1000, channel = "Bank")

  # Move 200 to savings using UUID
  main_acc$move_balance(savings$uuid, 200)
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-list_all_accounts"></a><div class="section">
<h3 id="method-list-all-accounts-">Method <code>list_all_accounts()</code><a class="anchor" aria-label="anchor" href="#method-list-all-accounts-"></a></h3>
<p>Recursively lists the names of all accounts in the hierarchy, both upward
(towards ancestors) and downward (towards descendants), starting from the
current account. This method avoids revisiting any account by tracking
visited paths, preventing infinite loops in case of circular references.</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">list_all_accounts</span><span class="op">(</span>visited_paths <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>visited_paths</code></dt>
<dd><p>Optional list. Used internally for recursion to
avoid revisiting accounts. Should generally be left as `NULL` by the
user.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-13">Returns<a class="anchor" aria-label="anchor" href="#returns-13"></a></h4>
<p>A character vector of account names found across the full reachable tree
(both children and ancestors) from the current account.</p>
</div>
<div class="section">
<h4 id="examples-14">Examples<a class="anchor" aria-label="anchor" href="#examples-14"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Main")
  savings &lt;- ChildAccount$new("Savings", allocation = 0.4)
  emergency &lt;- ChildAccount$new("Emergency", allocation = 0.6)

  main_acc$add_child_account(savings)
  main_acc$add_child_account(emergency)

  # List all accounts from the root
  main_acc$list_all_accounts()
  # Output: "Main" "Savings" "Emergency"

  # List all accounts from a child node (will include parents)
  savings$list_all_accounts()
  # Output: "Savings" "Main" "Emergency"
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-compute_total_balance"></a><div class="section">
<h3 id="method-compute-total-balance-">Method <code>compute_total_balance()</code><a class="anchor" aria-label="anchor" href="#method-compute-total-balance-"></a></h3>
<p>Recursively computes the total balance held by the current account
and all of its child accounts. This method includes the balance of the
account on which it's called and traverses down the tree to sum balances
of all active descendants.</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">compute_total_balance</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-14">Returns<a class="anchor" aria-label="anchor" href="#returns-14"></a></h4>
<p>Numeric. The total aggregated balance of this account and its entire
descendant subtree.</p>
</div>
<div class="section">
<h4 id="examples-15">Examples<a class="anchor" aria-label="anchor" href="#examples-15"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Main")
  child1 &lt;- ChildAccount$new("Child1", allocation = 0.5)
  child2 &lt;- ChildAccount$new("Child2", allocation = 0.5)

  main_acc$add_child_account(child1)
  main_acc$add_child_account(child2)

  main_acc$deposit(100, channel = "Bank", transaction_number = "txn1")
  # This distributes 100 into child1 and child2 based on allocation

  # Check total balance recursively
  total &lt;- main_acc$compute_total_balance()
  print(total)
  # Should return 100 (main + children)
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-compute_total_due"></a><div class="section">
<h3 id="method-compute-total-due-">Method <code>compute_total_due()</code><a class="anchor" aria-label="anchor" href="#method-compute-total-due-"></a></h3>
<p>Recursively computes the total amount due for the current account and all
of its descendant child accounts. If `amount_due` is not defined in an
account, it defaults to zero.</p>
<p>This is useful for aggregating outstanding dues across the entire
hierarchical account structure (e.g., main → child → grandchild).</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">compute_total_due</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-15">Returns<a class="anchor" aria-label="anchor" href="#returns-15"></a></h4>
<p>Numeric. The total due amount for this account and all its descendants.</p>
</div>
<div class="section">
<h4 id="examples-16">Examples<a class="anchor" aria-label="anchor" href="#examples-16"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Main")
  child1 &lt;- ChildAccount$new("Child1", allocation = 0.6)
  child2 &lt;- ChildAccount$new("Child2", allocation = 0.4)

  main_acc$add_child_account(child1)
  main_acc$add_child_account(child2)

  # Manually set dues
  main_acc$amount_due &lt;- 50
  child1$amount_due &lt;- 20
  child2$amount_due &lt;- 30

  total_due &lt;- main_acc$compute_total_due()
  print(total_due)
  # Should return 100 (50 + 20 + 30)
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-compute_total_due_within_n_days"></a><div class="section">
<h3 id="method-compute-total-due-within-n-days-">Method <code>compute_total_due_within_n_days()</code><a class="anchor" aria-label="anchor" href="#method-compute-total-due-within-n-days-"></a></h3>
<p>Recursively computes the total amount due for the current account and all
child accounts where the due date is within the next <code>n</code> days from
the current system time.</p>
<p>This method is useful for identifying upcoming payments or obligations in
a multi-account hierarchy and prioritizing them based on urgency.</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">compute_total_due_within_n_days</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-11">Arguments<a class="anchor" aria-label="anchor" href="#arguments-11"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n</code></dt>
<dd><p>Integer. The number of days from today within which dues should
be considered. Dues without a due date are ignored.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-16">Returns<a class="anchor" aria-label="anchor" href="#returns-16"></a></h4>
<p>Numeric. The total due amount within the next <code>n</code> days
across the account hierarchy.</p>
</div>
<div class="section">
<h4 id="examples-17">Examples<a class="anchor" aria-label="anchor" href="#examples-17"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Main")
  child1 &lt;- ChildAccount$new("Child1", allocation = 0.6)
  child2 &lt;- ChildAccount$new("Child2", allocation = 0.4)

  main_acc$add_child_account(child1)
  main_acc$add_child_account(child2)

  # Assign dues and due dates
  main_acc$amount_due &lt;- 100
  main_acc$due_date &lt;- Sys.time() + 2 * 24 * 60 * 60  # Due in 2 days

  child1$amount_due &lt;- 50
  child1$due_date &lt;- Sys.time() + 5 * 24 * 60 * 60    # Due in 5 days

  child2$amount_due &lt;- 70
  child2$due_date &lt;- Sys.time() + 10 * 24 * 60 * 60   # Due in 10 days

  # Compute total dues within next 7 days
  total_due_7_days &lt;- main_acc$compute_total_due_within_n_days(7)
  print(total_due_7_days)
  # Should return 100 + 50 = 150
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-spending"></a><div class="section">
<h3 id="method-spending-">Method <code>spending()</code><a class="anchor" aria-label="anchor" href="#method-spending-"></a></h3>
<p>Recursively computes the total spending (i.e., user-initiated
withdrawals) for the current account and all child accounts within
 a specified date range.</p>
<p>Spending is defined as withdrawals made by the user (`By == "User"`),
excluding system-initiated or internal transfers. The function includes
both the current account and all of its descendants in the calculation.</p><div class="section">
<h4 id="usage-18">Usage<a class="anchor" aria-label="anchor" href="#usage-18"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">spending</span><span class="op">(</span>daterange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">365000</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-12">Arguments<a class="anchor" aria-label="anchor" href="#arguments-12"></a></h4>
<p></p><div class="arguments"><dl><dt><code>daterange</code></dt>
<dd><p>A Date or POSIXct vector of length 2. The start and
end dates for the period over which to compute spending. Defaults to
the entire timeline.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-17">Returns<a class="anchor" aria-label="anchor" href="#returns-17"></a></h4>
<p>Numeric. The total spending amount over the specified date range.</p>
</div>
<div class="section">
<h4 id="examples-18">Examples<a class="anchor" aria-label="anchor" href="#examples-18"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Main")
  child1 &lt;- ChildAccount$new("Child1", allocation = 0.5)
  child2 &lt;- ChildAccount$new("Child2", allocation = 0.5)

  main_acc$add_child_account(child1)
  main_acc$add_child_account(child2)

  # Simulate some deposits and withdrawals
  main_acc$deposit(500, "T1", By = "User", channel = "Cash")
  main_acc$withdraw(200, By = "User", channel = "Spending",
  date = Sys.time() - 10)
  child1$deposit(300, "T2", By = "User", channel = "Mobile")
  child1$withdraw(100, By = "User", channel = "Shopping",
  date = Sys.time() - 5)

  # Get total user spending in last 30 days
  main_acc$spending(c(Sys.Date() - 30, Sys.Date()))
  # Should return 200 + 100 = 300
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-total_income"></a><div class="section">
<h3 id="method-total-income-">Method <code>total_income()</code><a class="anchor" aria-label="anchor" href="#method-total-income-"></a></h3>
<p>Recursively computes the total income (i.e., user-initiated deposits)
for the current account and all of its child accounts within a specified
date range.</p>
<p>This function sums up all "Deposit" transactions where the `By` field is
set to `"User"`. It includes both the current account and all of its
descendants in the income calculation.</p><div class="section">
<h4 id="usage-19">Usage<a class="anchor" aria-label="anchor" href="#usage-19"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">total_income</span><span class="op">(</span>daterange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">365000</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-13">Arguments<a class="anchor" aria-label="anchor" href="#arguments-13"></a></h4>
<p></p><div class="arguments"><dl><dt><code>daterange</code></dt>
<dd><p>A vector of two Dates or POSIXct objects specifying the
start and end dates for the income calculation. Defaults to the entire
timeline.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-18">Returns<a class="anchor" aria-label="anchor" href="#returns-18"></a></h4>
<p>A numeric value representing the total income across all relevant
accounts within the specified date range.</p>
</div>
<div class="section">
<h4 id="examples-19">Examples<a class="anchor" aria-label="anchor" href="#examples-19"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Main")
  child1 &lt;- ChildAccount$new("Child1", allocation = 0.5)
  child2 &lt;- ChildAccount$new("Child2", allocation = 0.5)

  main_acc$add_child_account(child1)
  main_acc$add_child_account(child2)

  # Simulate some deposits
  main_acc$deposit(500, "TX01", By = "User", channel = "Cash",
  date = Sys.time() - 7)
  child1$deposit(300, "TX02", By = "User", channel = "Mobile",
  date = Sys.time() - 3)

  # Get total income in last 10 days
  main_acc$total_income(c(Sys.Date() - 10, Sys.Date()))
  # Should return 500 + 300 = 800
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-allocated_amount"></a><div class="section">
<h3 id="method-allocated-amount-">Method <code>allocated_amount()</code><a class="anchor" aria-label="anchor" href="#method-allocated-amount-"></a></h3>
<p>Calculates the total allocated amount to this account and its child
accounts over a specified date range.</p>
<p>This includes **all deposits** (from both `"User"` and `"System"`)
into the current account, **plus** all **user-initiated** deposits
into child and deeper-level descendant accounts. It provides insight
into how much funding (regardless of origin) has been allocated directly
 or indirectly to this node in the account tree.</p><div class="section">
<h4 id="usage-20">Usage<a class="anchor" aria-label="anchor" href="#usage-20"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">allocated_amount</span><span class="op">(</span>daterange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">365000</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-14">Arguments<a class="anchor" aria-label="anchor" href="#arguments-14"></a></h4>
<p></p><div class="arguments"><dl><dt><code>daterange</code></dt>
<dd><p>A vector of two `Date` or `POSIXct` objects specifying
the start and end dates for the deposit aggregation. Defaults to a very
wide range.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-19">Returns<a class="anchor" aria-label="anchor" href="#returns-19"></a></h4>
<p>A numeric value representing the total allocated amount across
the account and its descendants within the specified date range.</p>
</div>
<div class="section">
<h4 id="examples-20">Examples<a class="anchor" aria-label="anchor" href="#examples-20"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  main_acc &lt;- MainAccount$new("Main")
  child1 &lt;- ChildAccount$new("Child1", allocation = 0.5)
  child2 &lt;- ChildAccount$new("Child2", allocation = 0.5)

  main_acc$add_child_account(child1)
  main_acc$add_child_account(child2)

  main_acc$deposit(1000, "TX001", By = "System", channel = "Bank",
  date = Sys.time() - 5)
  child1$deposit(300, "TX002", By = "User", channel = "Mobile",
  date = Sys.time() - 3)
  child2$deposit(200, "TX003", By = "User", channel = "Cash",
  date = Sys.time() - 2)

  # Get total allocated amount within last 7 days
  main_acc$allocated_amount(c(Sys.Date() - 7, Sys.Date()))
  # Expected output: 1000 (System) + 300 + 200 = 1500
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-income_utilization"></a><div class="section">
<h3 id="method-income-utilization-">Method <code>income_utilization()</code><a class="anchor" aria-label="anchor" href="#method-income-utilization-"></a></h3>
<p>Computes the **income utilization ratio** over a specified date range.</p>
<p>This is calculated as the ratio of total user withdrawals
(`spending`) to the total allocated income (`allocated_amount`).
It measures how effectively funds are being used relative to the total
 amount deposited (both by user and system).</p>
<p>A value close to 1 indicates high utilization (most funds spent),
while a valueclose to 0 indicates low spending relative to funds
received.</p><div class="section">
<h4 id="usage-21">Usage<a class="anchor" aria-label="anchor" href="#usage-21"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">income_utilization</span><span class="op">(</span>daterange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">365000</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-15">Arguments<a class="anchor" aria-label="anchor" href="#arguments-15"></a></h4>
<p></p><div class="arguments"><dl><dt><code>daterange</code></dt>
<dd><p>A vector of two `Date` or `POSIXct` values defining the
date range for the calculation. Defaults to a large historical window.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-20">Returns<a class="anchor" aria-label="anchor" href="#returns-20"></a></h4>
<p>A numeric value (between 0 and potentially &gt;1) representing
the income utilization ratio. If no income has been allocated, a small
epsilon is added to the denominator to avoid division by zero.</p>
</div>
<div class="section">
<h4 id="examples-21">Examples<a class="anchor" aria-label="anchor" href="#examples-21"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
  account &lt;- MainAccount$new("Parent")
  account$deposit(1000, "TX001", By = "System", channel = "Bank")
  account$withdraw(200, By = "User", channel = "Mobile")

  account$income_utilization()
  # Expected output: 200 / 1000 = 0.2
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-walking_amount"></a><div class="section">
<h3 id="method-walking-amount-">Method <code>walking_amount()</code><a class="anchor" aria-label="anchor" href="#method-walking-amount-"></a></h3>
<p>Computes the **latest recorded amount** (either `amount_due` or
`balance`) from the `Track_dues_and_balance` tracker for the current
account and all its child accounts within a specified date range.</p>
<p>It retrieves the latest entry in the given date range, and
recursively sums the values for all child accounts.</p><div class="section">
<h4 id="usage-22">Usage<a class="anchor" aria-label="anchor" href="#usage-22"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">walking_amount</span><span class="op">(</span></span>
<span>  amt_type <span class="op">=</span> <span class="st">"amount_due"</span>,</span>
<span>  daterange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">365000</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-16">Arguments<a class="anchor" aria-label="anchor" href="#arguments-16"></a></h4>
<p></p><div class="arguments"><dl><dt><code>amt_type</code></dt>
<dd><p>A string specifying the metric to return:
- `"amount_due"`: Return the last tracked `Amount_due`.
- `"Balance"`: Return the last tracked `Balance`.</p></dd>


<dt><code>daterange</code></dt>
<dd><p>A vector of two dates (of class `Date` or
`POSIXct`)
specifying the time window. Default: wide historical range.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-21">Returns<a class="anchor" aria-label="anchor" href="#returns-21"></a></h4>
<p>A numeric value representing the sum of either latest
`Amount_due` or `Balance` from this account and all its children.</p>
</div>
<div class="section">
<h4 id="examples-22">Examples<a class="anchor" aria-label="anchor" href="#examples-22"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
account$walking_amount("amount_due", c(Sys.Date() - 30,
Sys.Date()))
account$walking_amount("Balance", c(Sys.Date() - 7, Sys.Date()))
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MainAccount-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-23">Usage<a class="anchor" aria-label="anchor" href="#usage-23"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MainAccount</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-17">Arguments<a class="anchor" aria-label="anchor" href="#arguments-17"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r6.r-lib.org" class="external-link">R6</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rforge.net/uuid" class="external-link">uuid</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Create a main account</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Salary Pool"</span>, balance <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a system transaction ID</span></span></span>
<span class="r-in"><span><span class="va">acc</span><span class="op">$</span><span class="fu">generate_transaction_id</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sys1"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check for duplicate transaction ID</span></span></span>
<span class="r-in"><span><span class="va">acc</span><span class="op">$</span><span class="fu">is_duplicate_transaction</span><span class="op">(</span><span class="st">"sys1"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect balance</span></span></span>
<span class="r-in"><span><span class="va">acc</span><span class="op">$</span><span class="va">balance</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect UUID</span></span></span>
<span class="r-in"><span><span class="va">acc</span><span class="op">$</span><span class="va">uuid</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "acc57aeaa88-2f76-48fb-a961-953f77d24376"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$new`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"My Main Account"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">main_acc</span><span class="op">$</span><span class="va">uuid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">main_acc</span><span class="op">$</span><span class="va">balance</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">main_acc</span><span class="op">$</span><span class="va">transactions</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$generate_transaction_id`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Salary Pool"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">txn_id1</span> <span class="op">&lt;-</span> <span class="va">main_acc</span><span class="op">$</span><span class="fu">generate_transaction_id</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">txn_id2</span> <span class="op">&lt;-</span> <span class="va">main_acc</span><span class="op">$</span><span class="fu">generate_transaction_id</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">txn_id1</span><span class="op">)</span>  <span class="co"># e.g., "sys1"</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">txn_id2</span><span class="op">)</span>  <span class="co"># e.g., "sys2"</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$is_duplicate_transaction`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="co"># Create a new main account</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Salary Pool"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Manually add a transaction with ID "sys1"</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="va">transactions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Type <span class="op">=</span> <span class="st">"Income"</span>,</span></span>
<span class="r-in"><span>    By <span class="op">=</span> <span class="st">"User"</span>,</span></span>
<span class="r-in"><span>    TransactionID <span class="op">=</span> <span class="st">"sys1"</span>,</span></span>
<span class="r-in"><span>    Channel <span class="op">=</span> <span class="st">"Bank"</span>,</span></span>
<span class="r-in"><span>    Amount <span class="op">=</span> <span class="fl">5000</span>,</span></span>
<span class="r-in"><span>    Balance <span class="op">=</span> <span class="fl">5000</span>,</span></span>
<span class="r-in"><span>    amount_due <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    overall_balance <span class="op">=</span> <span class="fl">5000</span>,</span></span>
<span class="r-in"><span>    Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Check for duplicate</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">is_duplicate_transaction</span><span class="op">(</span><span class="st">"sys1"</span><span class="op">)</span>  <span class="co"># Returns TRUE</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">is_duplicate_transaction</span><span class="op">(</span><span class="st">"sys2"</span><span class="op">)</span>  <span class="co"># Returns FALSE</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$deposit`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Salary Pool"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span></span></span>
<span class="r-in"><span>    amount <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    channel <span class="op">=</span> <span class="st">"Bank Transfer"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$distribute_to_children`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Salary Pool"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Food Fund"</span>, allocation <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child2</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Savings"</span>, allocation <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span>amount <span class="op">=</span> <span class="fl">1000</span>, channel <span class="op">=</span> <span class="st">"Bank"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># This will trigger distribute_to_children internally.</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$add_child_account`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Master"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child_acc</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Savings"</span>, allocation <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child_acc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$set_child_allocation`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Emergency"</span>, allocation <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">set_child_allocation</span><span class="op">(</span><span class="st">"Emergency"</span>, <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$withdraw`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Primary Pool"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span>amount <span class="op">=</span> <span class="fl">1000</span>, channel <span class="op">=</span> <span class="st">"Mobile"</span>, by <span class="op">=</span> <span class="st">"User"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">withdraw</span><span class="op">(</span>amount <span class="op">=</span> <span class="fl">200</span>, channel <span class="op">=</span> <span class="st">"ATM"</span>, by <span class="op">=</span> <span class="st">"User"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$get_balance`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Primary Pool"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span>amount <span class="op">=</span> <span class="fl">500</span>, channel <span class="op">=</span> <span class="st">"Bank Transfer"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">get_balance</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$get_transactions`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main Budget"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">acc</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">500</span>, channel <span class="op">=</span> <span class="st">"M-Pesa"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">acc</span><span class="op">$</span><span class="fu">get_transactions</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$list_child_accounts`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main Budget"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Bills"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">list_child_accounts</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># Recursively find all accounts by name</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$find_account`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">savings1</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Savings"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">savings2</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Savings"</span>, allocation <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">savings1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">savings2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">found</span> <span class="op">&lt;-</span> <span class="va">main</span><span class="op">$</span><span class="fu">find_account</span><span class="op">(</span><span class="st">"Savings"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">found</span><span class="op">)</span>  <span class="co"># 2</span></span></span>
<span class="r-in"><span>  <span class="va">found</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">uuid</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$find_account_by_uuid`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Root"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">groceries</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Groceries"</span>, allocation <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">groceries</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">found</span> <span class="op">&lt;-</span> <span class="va">main_acc</span><span class="op">$</span><span class="fu">find_account_by_uuid</span><span class="op">(</span><span class="va">groceries</span><span class="op">$</span><span class="va">uuid</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">found</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Found UUID:"</span>, <span class="va">found</span><span class="op">$</span><span class="va">uuid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># Move balance to another account (by UUID)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$move_balance`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">savings</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Savings"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">emergency</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Emergency"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">savings</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">emergency</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Initial deposit</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">1000</span>, channel <span class="op">=</span> <span class="st">"Bank"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Move 200 to savings using UUID</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">move_balance</span><span class="op">(</span><span class="va">savings</span><span class="op">$</span><span class="va">uuid</span>, <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$list_all_accounts`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">savings</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Savings"</span>, allocation <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">emergency</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Emergency"</span>, allocation <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">savings</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">emergency</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># List all accounts from the root</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">list_all_accounts</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Output: "Main" "Savings" "Emergency"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># List all accounts from a child node (will include parents)</span></span></span>
<span class="r-in"><span>  <span class="va">savings</span><span class="op">$</span><span class="fu">list_all_accounts</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Output: "Savings" "Main" "Emergency"</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$compute_total_balance`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child1"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child2</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child2"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">100</span>, channel <span class="op">=</span> <span class="st">"Bank"</span>, transaction_number <span class="op">=</span> <span class="st">"txn1"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># This distributes 100 into child1 and child2 based on allocation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Check total balance recursively</span></span></span>
<span class="r-in"><span>  <span class="va">total</span> <span class="op">&lt;-</span> <span class="va">main_acc</span><span class="op">$</span><span class="fu">compute_total_balance</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Should return 100 (main + children)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$compute_total_due`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child1"</span>, allocation <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child2</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child2"</span>, allocation <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Manually set dues</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="va">amount_due</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span><span class="op">$</span><span class="va">amount_due</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span>  <span class="va">child2</span><span class="op">$</span><span class="va">amount_due</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">total_due</span> <span class="op">&lt;-</span> <span class="va">main_acc</span><span class="op">$</span><span class="fu">compute_total_due</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">total_due</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Should return 100 (50 + 20 + 30)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$compute_total_due_within_n_days`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child1"</span>, allocation <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child2</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child2"</span>, allocation <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Assign dues and due dates</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="va">amount_due</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="va">due_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span>  <span class="co"># Due in 2 days</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">child1</span><span class="op">$</span><span class="va">amount_due</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span><span class="op">$</span><span class="va">due_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span>    <span class="co"># Due in 5 days</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">child2</span><span class="op">$</span><span class="va">amount_due</span> <span class="op">&lt;-</span> <span class="fl">70</span></span></span>
<span class="r-in"><span>  <span class="va">child2</span><span class="op">$</span><span class="va">due_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span> <span class="op">*</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span>   <span class="co"># Due in 10 days</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compute total dues within next 7 days</span></span></span>
<span class="r-in"><span>  <span class="va">total_due_7_days</span> <span class="op">&lt;-</span> <span class="va">main_acc</span><span class="op">$</span><span class="fu">compute_total_due_within_n_days</span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">total_due_7_days</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Should return 100 + 50 = 150</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$spending`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child1"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child2</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child2"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Simulate some deposits and withdrawals</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">500</span>, <span class="st">"T1"</span>, By <span class="op">=</span> <span class="st">"User"</span>, channel <span class="op">=</span> <span class="st">"Cash"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">withdraw</span><span class="op">(</span><span class="fl">200</span>, By <span class="op">=</span> <span class="st">"User"</span>, channel <span class="op">=</span> <span class="st">"Spending"</span>,</span></span>
<span class="r-in"><span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">300</span>, <span class="st">"T2"</span>, By <span class="op">=</span> <span class="st">"User"</span>, channel <span class="op">=</span> <span class="st">"Mobile"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span><span class="op">$</span><span class="fu">withdraw</span><span class="op">(</span><span class="fl">100</span>, By <span class="op">=</span> <span class="st">"User"</span>, channel <span class="op">=</span> <span class="st">"Shopping"</span>,</span></span>
<span class="r-in"><span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Get total user spending in last 30 days</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">spending</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">30</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Should return 200 + 100 = 300</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$total_income`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child1"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child2</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child2"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Simulate some deposits</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">500</span>, <span class="st">"TX01"</span>, By <span class="op">=</span> <span class="st">"User"</span>, channel <span class="op">=</span> <span class="st">"Cash"</span>,</span></span>
<span class="r-in"><span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">300</span>, <span class="st">"TX02"</span>, By <span class="op">=</span> <span class="st">"User"</span>, channel <span class="op">=</span> <span class="st">"Mobile"</span>,</span></span>
<span class="r-in"><span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Get total income in last 10 days</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">total_income</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Should return 500 + 300 = 800</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$allocated_amount`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child1"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child2</span> <span class="op">&lt;-</span> <span class="va"><a href="ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Child2"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">child2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">1000</span>, <span class="st">"TX001"</span>, By <span class="op">=</span> <span class="st">"System"</span>, channel <span class="op">=</span> <span class="st">"Bank"</span>,</span></span>
<span class="r-in"><span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child1</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">300</span>, <span class="st">"TX002"</span>, By <span class="op">=</span> <span class="st">"User"</span>, channel <span class="op">=</span> <span class="st">"Mobile"</span>,</span></span>
<span class="r-in"><span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">child2</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">200</span>, <span class="st">"TX003"</span>, By <span class="op">=</span> <span class="st">"User"</span>, channel <span class="op">=</span> <span class="st">"Cash"</span>,</span></span>
<span class="r-in"><span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Get total allocated amount within last 7 days</span></span></span>
<span class="r-in"><span>  <span class="va">main_acc</span><span class="op">$</span><span class="fu">allocated_amount</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">7</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Expected output: 1000 (System) + 300 + 200 = 1500</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$income_utilization`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">account</span> <span class="op">&lt;-</span> <span class="va">MainAccount</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Parent"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">account</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">1000</span>, <span class="st">"TX001"</span>, By <span class="op">=</span> <span class="st">"System"</span>, channel <span class="op">=</span> <span class="st">"Bank"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">account</span><span class="op">$</span><span class="fu">withdraw</span><span class="op">(</span><span class="fl">200</span>, By <span class="op">=</span> <span class="st">"User"</span>, channel <span class="op">=</span> <span class="st">"Mobile"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">account</span><span class="op">$</span><span class="fu">income_utilization</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Expected output: 200 / 1000 = 0.2</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `MainAccount$walking_amount`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">account</span><span class="op">$</span><span class="fu">walking_amount</span><span class="op">(</span><span class="st">"amount_due"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">account</span><span class="op">$</span><span class="fu">walking_amount</span><span class="op">(</span><span class="st">"Balance"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">7</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/statisticsguru1" class="external-link">Festus Nzuma</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

