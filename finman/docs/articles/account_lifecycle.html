<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="finman">
<title>Account Lifecycle and Behavior â€¢ finman</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Account Lifecycle and Behavior">
<meta property="og:description" content="finman">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">finman</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/account_lifecycle.html">Account Lifecycle and Behavior</a>
    <a class="dropdown-item" href="../articles/allocation_strategies.html">Income Allocation Strategies</a>
    <a class="dropdown-item" href="../articles/finman-overview.html">finman-overview</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../../">Main Docs</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../api/">API</a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Account Lifecycle and Behavior</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/statisticsguru1/personal-finance-manager/blob/HEAD/../vignettes/account_lifecycle.Rmd" class="external-link"><code>../vignettes/account_lifecycle.Rmd</code></a></small>
      <div class="d-none name"><code>account_lifecycle.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.3.3</span></span>
<span><span class="co">#&gt; Warning: package 'tidyr' was built under R version 4.3.3</span></span>
<span><span class="co">#&gt; Warning: package 'readr' was built under R version 4.3.3</span></span>
<span><span class="co">#&gt; Warning: package 'purrr' was built under R version 4.3.3</span></span>
<span><span class="co">#&gt; Warning: package 'dplyr' was built under R version 4.3.3</span></span>
<span><span class="co">#&gt; Warning: package 'stringr' was built under R version 4.3.3</span></span>
<span><span class="co">#&gt; Warning: package 'lubridate' was built under R version 4.3.3</span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Attaching core tidyverse packages</span> â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.0     <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">purrr    </span> 1.0.4     </span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Conflicts</span> â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">âœ–</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">âœ–</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/statisticsguru1/personal-finance-manager/tree/refactor-main-account-docs" class="external-link">finman</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="account-lifecycle-and-behavior">ğŸ”„ Account Lifecycle and Behavior<a class="anchor" aria-label="anchor" href="#account-lifecycle-and-behavior"></a>
</h2>
<p>This vignette explains how <code>finman</code> manages the
<strong>life cycle</strong> of accounts â€” from creation, activation,
allocation, and reactivation after obligations are met or missed.</p>
<div class="section level3">
<h3 id="account-creation">ğŸ—ï¸ 1. Account Creation<a class="anchor" aria-label="anchor" href="#account-creation"></a>
</h3>
<p>Accounts in <code>finman</code> are hierarchical:</p>
<ul>
<li>
<code>MainAccount</code> sits at the top and receives deposits.</li>
<li>
<code>ChildAccount</code>s receive allocations from the main account
(group of obligations).</li>
<li>
<code>GrandchildAccount</code>s track specific obligations like
rent, loans insurance etc.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/MainAccount.html">MainAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Main"</span><span class="op">)</span></span>
<span><span class="va">needs</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Needs"</span>, allocation <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">savings</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Savings"</span>, allocation <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">debt</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ChildAccount.html">ChildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Debt"</span>, allocation <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">main</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">needs</span><span class="op">)</span></span>
<span><span class="va">main</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">savings</span><span class="op">)</span></span>
<span><span class="va">main</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">debt</span><span class="op">)</span></span>
<span><span class="co"># Simulate overdue</span></span>
<span><span class="va">rent</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GrandchildAccount.html">GrandchildAccount</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Rent"</span>, </span>
<span>                              freq <span class="op">=</span><span class="fl">1</span>,</span>
<span>                              due_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">6</span>,</span>
<span>                              fixed_amount <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>                              account_type <span class="op">=</span> <span class="st">"Bill"</span><span class="op">)</span></span>
<span><span class="va">needs</span><span class="op">$</span><span class="fu">add_child_account</span><span class="op">(</span><span class="va">rent</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="account-status-active-vs-inactive">ğŸ”‹ 2. Account Status: Active vs Inactive<a class="anchor" aria-label="anchor" href="#account-status-active-vs-inactive"></a>
</h3>
<ul>
<li>Accounts with no allocation (<code>allocation = 0</code>) are
<strong>inactive</strong> by default.</li>
<li>Accounts become <strong>inactive</strong> when their obligations are
fully met.</li>
<li>Inactive accounts do not receive allocations.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rent</span><span class="op">$</span><span class="va">status</span>  <span class="co"># "inactive"</span></span>
<span><span class="co">#&gt; [1] "inactive"</span></span></code></pre></div>
<div class="section level4">
<h4 id="reactivating-accounts">ğŸ› ï¸ Reactivating Accounts<a class="anchor" aria-label="anchor" href="#reactivating-accounts"></a>
</h4>
<p>Accounts are reactivated automatically when:</p>
<ul>
<li>Their due date is reached or passed.</li>
<li>They have pending obligations (unpaid periods).</li>
</ul>
<p>You can also manually reactivate:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">needs</span><span class="op">$</span><span class="fu">set_child_allocation</span><span class="op">(</span><span class="st">"Rent"</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Child Accounts of Needs :</span></span>
<span><span class="co">#&gt; - Rent</span></span>
<span><span class="va">rent</span><span class="op">$</span><span class="fu">change_status</span><span class="op">(</span><span class="st">"active"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rent has become active .</span></span>
<span><span class="va">rent</span><span class="op">$</span><span class="va">status</span></span>
<span><span class="co">#&gt; [1] "active"</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="automatic-reactivation-by-due-date">ğŸ” 3. Automatic Reactivation by Due Date<a class="anchor" aria-label="anchor" href="#automatic-reactivation-by-due-date"></a>
</h3>
<p>When a deposit is made for bills and the due date has passed, the
account will automatically extend the due period and reactivate
itself:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rent</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">10000</span>, channel <span class="op">=</span> <span class="st">"Bank"</span>,date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">8</span><span class="op">)</span> <span class="co"># funded days before due</span></span>
<span><span class="co">#&gt; Deposited: 5000 via Bank - Transaction ID: sys1 </span></span>
<span><span class="co">#&gt; Rent has become inactive .</span></span>
<span><span class="co">#&gt; Extra amount of 5000 moved to Needs </span></span>
<span><span class="co">#&gt; Rent fully funded for 1 period(s)</span></span>
<span><span class="va">rent</span><span class="op">$</span><span class="fu">get_account_status</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rent is inactive</span></span>
<span><span class="co">#&gt; [1] "inactive"</span></span>
<span><span class="va">rent</span><span class="op">$</span><span class="fu">get_account_periods</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rent</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">1000</span>, channel <span class="op">=</span> <span class="st">"Bank"</span>,date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Due date extended. Number of periods unpaid: 2 </span></span>
<span><span class="co">#&gt; Rent reactivated. Outstanding balance due: 5000 </span></span>
<span><span class="co">#&gt; Deposited: 1000 via Bank - Transaction ID: sys2</span></span>
<span><span class="va">rent</span><span class="op">$</span><span class="fu">get_account_status</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rent is active</span></span>
<span><span class="co">#&gt; [1] "active"</span></span>
<span><span class="va">rent</span><span class="op">$</span><span class="fu">get_account_periods</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="priority-based-greedy-allocation">ğŸ“ˆ 4. Priority-Based Greedy Allocation<a class="anchor" aria-label="anchor" href="#priority-based-greedy-allocation"></a>
</h3>
<p>If multiple children are active, allocations follow the
<code>priority</code> field:</p>
<ul>
<li>Higher priority accounts receive funds first.</li>
<li>Allocation is based on defined percentages
(<code>allocation</code>).so all active children receive their share
proportionally.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rent</span><span class="op">$</span><span class="fu">change_status</span><span class="op">(</span><span class="st">"active"</span><span class="op">)</span>  <span class="co"># ensure rent is active</span></span>
<span><span class="co">#&gt; Rent has become active .</span></span>
<span><span class="va">main</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">20000</span>, channel <span class="op">=</span> <span class="st">"Equity Bank"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Withdrew: 10000 via Allocation to Needs - Transaction ID: sys2 </span></span>
<span><span class="co">#&gt; Withdrew: 10000 via Allocation to Rent - Transaction ID: sys2 </span></span>
<span><span class="co">#&gt; Due date extended. Number of periods unpaid: 3 </span></span>
<span><span class="co">#&gt; Rent reactivated. Outstanding balance due: 9000 </span></span>
<span><span class="co">#&gt; Deposited: 9000 via Allocation from Needs - Transaction ID: sys1 </span></span>
<span><span class="co">#&gt; Rent has become inactive .</span></span>
<span><span class="co">#&gt; Extra amount of 1000 moved to Needs </span></span>
<span><span class="co">#&gt; Rent fully funded for 3 period(s)</span></span>
<span><span class="co">#&gt; Deposited: 10000 via Allocation from Main - Transaction ID: sys1 </span></span>
<span><span class="co">#&gt; Withdrew: 6000 via Allocation to Savings - Transaction ID: sys3 </span></span>
<span><span class="co">#&gt; Deposited: 6000 via Allocation from Main - Transaction ID: sys1 </span></span>
<span><span class="co">#&gt; Withdrew: 4000 via Allocation to Debt - Transaction ID: sys4 </span></span>
<span><span class="co">#&gt; Deposited: 4000 via Allocation from Main - Transaction ID: sys1 </span></span>
<span><span class="co">#&gt; Deposited: 20000 via Equity Bank - Transaction ID: sys1</span></span>
<span></span>
<span><span class="va">rent</span><span class="op">$</span><span class="fu">get_balance</span><span class="op">(</span><span class="op">)</span>      <span class="co"># Rent gets funds</span></span>
<span><span class="co">#&gt; Current Balance: 15000</span></span>
<span><span class="co">#&gt; [1] 15000</span></span>
<span><span class="va">needs</span><span class="op">$</span><span class="fu">get_balance</span><span class="op">(</span><span class="op">)</span>     <span class="co"># Needs balance reflects leftover after rent</span></span>
<span><span class="co">#&gt; Current Balance: 6000</span></span>
<span><span class="co">#&gt; [1] 6000</span></span>
<span><span class="va">main</span><span class="op">$</span><span class="fu">get_balance</span><span class="op">(</span><span class="op">)</span>      <span class="co"># Should be zero if all children are active</span></span>
<span><span class="co">#&gt; Current Balance: 0</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>However, since funds are distributed proportionally, the effect of
priority can be subtle â€” all active accounts still receive their
share.</p>
<p>Priority becomes most apparent when the deposited amount is too small
to distribute among all children. In such cases, the full amount is
allocated to the child with the highest priority.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set child priorities</span></span>
<span></span>
<span><span class="va">needs</span><span class="op">$</span><span class="fu">set_priority</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Priority for Needs set to 3</span></span>
<span><span class="va">savings</span><span class="op">$</span><span class="fu">set_priority</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Priority for Savings set to 2</span></span>
<span><span class="va">debt</span><span class="op">$</span><span class="fu">set_priority</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Priority for Debt set to 1</span></span>
<span></span>
<span><span class="co"># deposit money</span></span>
<span><span class="va">main</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">10000</span>, channel <span class="op">=</span> <span class="st">"Equity Bank"</span>,transaction_number <span class="op">=</span> <span class="st">"Trans1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Withdrew: 5000 via Allocation to Needs - Transaction ID: sys5</span></span>
<span><span class="co">#&gt; No active child accounts available.</span></span>
<span><span class="co">#&gt; Deposited: 5000 via Allocation from Main - Transaction ID: Trans1 </span></span>
<span><span class="co">#&gt; Withdrew: 3000 via Allocation to Savings - Transaction ID: sys6 </span></span>
<span><span class="co">#&gt; Deposited: 3000 via Allocation from Main - Transaction ID: Trans1 </span></span>
<span><span class="co">#&gt; Withdrew: 2000 via Allocation to Debt - Transaction ID: sys7 </span></span>
<span><span class="co">#&gt; Deposited: 2000 via Allocation from Main - Transaction ID: Trans1 </span></span>
<span><span class="co">#&gt; Deposited: 10000 via Equity Bank - Transaction ID: Trans1</span></span>
<span></span>
<span><span class="co"># distributions order follows priority see timestamps</span></span>
<span></span>
<span><span class="va">needstime</span><span class="op">=</span><span class="va">needs</span><span class="op">$</span><span class="va">transactions</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TransactionID</span><span class="op">==</span><span class="st">"Trans1"</span><span class="op">)</span></span>
<span><span class="va">savingstime</span><span class="op">=</span><span class="va">savings</span><span class="op">$</span><span class="va">transactions</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TransactionID</span><span class="op">==</span><span class="st">"Trans1"</span><span class="op">)</span></span>
<span><span class="va">debttime</span><span class="op">=</span><span class="va">debt</span><span class="op">$</span><span class="va">transactions</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TransactionID</span><span class="op">==</span><span class="st">"Trans1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"needs: %s"</span>,<span class="va">needstime</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "needs: 2025-07-17 19:40:06.472943"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"savings: %s"</span>,<span class="va">savingstime</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "savings: 2025-07-17 19:40:06.478499"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"debt: %s"</span>,<span class="va">debttime</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "debt: 2025-07-17 19:40:06.483335"</span></span></code></pre></div>
<blockquote>
<p>ğŸ’¡ If an account receives more than it needs, the extra is refunded
to the parent and possibly redistributed.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="handling-tiny-refunds-and-preventing-cyclic-redistribution">ğŸ”„ Handling Tiny Refunds and Preventing Cyclic Redistribution<a class="anchor" aria-label="anchor" href="#handling-tiny-refunds-and-preventing-cyclic-redistribution"></a>
</h3>
<p>Since refunds are returned to the parent account, they are treated as
regular deposits. This ensures that all deposit checks and validations
apply uniformly. However, because deposits trigger redistribution to
child accounts, this can inadvertently lead to cyclic loops, especially
when the refunded amount is very small (e.g., 0.00001).</p>
<p>To prevent such infinite allocation loops, any amount less than 0.10
is not redistributed among all children. Instead, the system deposits
the entire small amount into the highest-priority active child account.
This strategy maintains consistency while avoiding unnecessary
micro-redistribution.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">main</span><span class="op">$</span><span class="fu">deposit</span><span class="op">(</span><span class="fl">0.09</span>, channel <span class="op">=</span> <span class="st">"ABSA"</span>,transaction_number <span class="op">=</span> <span class="st">"Test: Small Allocation"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Amount too small to distribute. Depositing into the highest-priority child.</span></span>
<span><span class="co">#&gt; Withdrew: 0.09 via Allocation to Needs - Transaction ID: sys8</span></span>
<span><span class="co">#&gt; No active child accounts available.</span></span>
<span><span class="co">#&gt; Deposited: 0.09 via Allocation from Main - Transaction ID: Test: Small Allocation </span></span>
<span><span class="co">#&gt; Deposited: 0.09 via ABSA - Transaction ID: Test: Small Allocation</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="summary">âœ… Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<ul>
<li>Accounts can be nested, allocated funds, and tracked
independently.</li>
<li>
<code>finman</code> intelligently handles activation, deactivation,
and reallocation.</li>
<li>Periodic obligations trigger reactivation, while priorities
determine allocation order.</li>
</ul>
<p>This lifecycle ensures money flows where itâ€™s most needed, without
micromanaging every transaction.</p>
<hr>
<p>Next: Try the <a href="tracking-obligations.html"><code>tracking-obligations</code></a>
vignette to dive deeper into bills and debts.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/statisticsguru1" class="external-link">Festus Nzuma</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
